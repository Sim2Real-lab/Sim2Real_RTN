{% extends "staff_home/base.html" %}

{%block extra_styles%%}
.team-card {
  background: rgba(255, 255, 255, 0.05);
  padding: 1rem;
  margin-bottom: 1rem;
  border-radius: 12px;
  color: #fff; /* make text visible on dark bg */
}

.container{
    background: rgba(255, 255, 255, 0.05) !important;
  padding: 1rem !important;
  margin-bottom: 1rem !important;
  border-radius: 12px !important;
  color: #fff !important; /* make text visible on dark bg */
}
.modal {
  display: none;
  position: fixed;
  z-index: 1000;
  padding-top: 60px;
  left: 0; top: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.9);
}

.modal-content {
  display: block;
  margin: auto;
  max-width: 80%;
  border-radius: 10px;
}

.close {
  position: absolute;
  top: 20px; right: 35px;
  font-size: 40px;
  color: #fff;
  cursor: pointer;
}
{%endblock%}
{% block content %}
<div class="container">
    <h2>Payment Verification</h2>

    <!-- Filters -->
    <form method="get">
        <input type="text" name="q" placeholder="Search team/leader" value="{{ query }}">
        <select name="status">
            <option value="">All</option>
            <option value="pending" {% if status_filter == "pending" %}selected{% endif %}>Pending</option>
            <option value="verified" {% if status_filter == "verified" %}selected{% endif %}>Verified</option>
            <option value="rejected" {% if status_filter == "rejected" %}selected{% endif %}>Rejected</option>
        </select>
        <button type="submit">Apply</button>
    </form>

    <hr>

    {% if teams %}
        {% for team in teams %}
            <div class="Container">
                <h3>{{ team.name }}</h3>
                <p><b>Leader:</b> {{ team.leader.username }}</p>
                <p><b>Members:</b> 
                    {% for member in team.members.all %}
                        {{ member.username }}{% if not forloop.last %}, {% endif %}
                    {% endfor %}
                </p>
                <p><b>Status:</b>
                    {% if team.is_verified %} ‚úÖ Verified
                    {% elif team.is_paid %} ‚è≥ Pending
                    {% else %} ‚ùå Rejected
                    {% endif %}
                </p>

                {% if team.payment_proof %}
                    <button type="button" onclick="toggleScreenshot('ss{{ team.id }}')">üì∑ View Proof</button>
                    <img id="ss{{ team.id }}" src="{{ team.payment_proof.url }}" style="max-width:300px; display:none;">
                {% endif %}

                <form method="post">
                    {% csrf_token %}
                    <input type="hidden" name="team_id" value="{{ team.id }}">
                    <button type="submit" name="action" value="verify">‚úÖ Verify</button>
                    <button type="submit" name="action" value="reject">‚ùå Reject</button>
                </form>
            </div>
            <hr>
        {% endfor %}
    {% else %}
        <p>No teams found.</p>
    {% endif %}
</div>

<script>
function toggleScreenshot(id) {
    let img = document.getElementById(id);
    img.style.display = img.style.display === "none" ? "block" : "none";
}
</script>
{% endblock %}
