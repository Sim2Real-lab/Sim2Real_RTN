{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SIM2REAL | ROBOTECH-NITK</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Custom CSS (will be updated by you soon) -->
  <link rel="stylesheet" href="{%static "home/style.css" %}">
  <link rel="icon" type="image/png" sizes="32x32" href="{% static 'assets/sim2real_logo.png' %}">
<link rel="icon" type="image/png" sizes="16x16" href="{% static 'assets/sim2real_logo.png' %}">
<link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/sim2real_logo.png' %}">
<link rel="shortcut icon" href="{% static 'assets/sim2real_logo.png' %}">
</head>
<body>
{% if show_welcome %}
<div id="welcome-overlay">
    Welcome to <strong style="margin-left: 10px;">Sim2Real</strong>
</div>
<div class="gear"></div>
{% endif %}

<!-- Main dashboard content here -->
<div id="main-content" {% if show_welcome %}style="visibility: hidden;"{% endif %}>
    <!-- Your actual dashboard content -->
</div>
<!-- Main body background for the Sim2Real theme -->
<div class="body-background"></div> 

<div class="top-panel">
<header class="d-flex justify-content-between align-items-center px-4 py-3">
  <div class="site-branding">
    <h1 class="mb-0">SIM2REAL 2025</h1>
    <p class="mb-0"><strong>ROBOTECH NITK</strong></p>
    <p class="tagline">Simulate. Build. Compete.</p>
  </div>
</header>

<nav class="navbar navbar-expand-md navbar-dark bg-dark sticky-top">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">SIM2REAL 2025</a>

    <!-- Hamburger for mobile -->
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboardNav"
      aria-controls="dashboardNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="dashboardNav">
      <ul class="navbar-nav me-auto mb-2 mb-md-0">
        <li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Dashboard</a></li>
        {% if not registered %}
        <li class="nav-item"><a class="nav-link" href="{% url 'manage_requests' %}">Register</a></li>
        <li class="nav-item"><a class="btn btn-success" href="{% url 'download_brochure' %}">Download Brochure</a></li>
        {% endif %}
        {% if registered %}
        <li class="nav-item"><a class="nav-link" href="{% url 'problem_statement' %}">Problem Statement</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'resources' %}">Resources</a></li>
        {% endif %}
        <li class="nav-item"><a class="nav-link" href="{% url 'announcements' %}">Announcements</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'user_query' %}">Queries-Ask Us</a></li>
      </ul>

      {% if user.is_authenticated %}
      <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="dropdownUser1"
             role="button" data-bs-toggle="dropdown" aria-expanded="false">
            <img src="{% static 'assets/default.png' %}" alt="Profile" class="profile-img rounded-circle me-2">
            {{ user.username }}
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdownUser1">
            <li><a class="dropdown-item" href="{% url 'profile' %}"><i class="fas fa-user me-2"></i>My Profile</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="{% url 'teamprofile' %}"><i class="fas fa-users me-2"></i>Team Profile</a></li>
            {% if user.led_team %}
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="{% url 'manage_requests' %}"><i class="fas fa-cogs me-2"></i>Manage Team</a></li>
            {% endif %}
            <li><hr class="dropdown-divider"></li>
            <li>
              <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
                <button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt me-2"></i>Logout</button>
              </form>
            </li>
          </ul>
        </li>
      </ul>
      {% endif %}
    </div>
  </div>
</nav>

</div>

<div class="container main-content-area mt-4">
  {% block content %}
  <!-- Dynamic content relevant to a logged-in hackathon participant -->
  <section class="dashboard-section p-4 rounded-lg shadow-lg">
    <h2 class="text-center mb-4">Sim2Real 2025 Dashboard</h2>

    {%if not registered and paid%}
    <div class="card registration-card mb-4">
        <div class="card-body text-center">
            <h3 class="card-title">âœ… Payment Detail Submitted! Waiting for Confirmation</h3>
            <p class="card-text">You have already submitted Payment Details </br>Waiting for organisers to verify.</p>
        </div>
    </div>
    {% elif not registered %} {# Placeholder condition #}
    <div class="card registration-card mb-4">
        <div class="card-body text-center">
            <h3 class="card-title">ðŸš€ Ready to Simulate to Real?</h3>
            <p class="card-text">Registration Closes on 14 September 2025.</br>If you have registered on Google form make your team and upload necessary details to access problem Statement.</p>
            <a href="{% url 'manage_requests' %}" class="btn btn-glow">Register Now!</a>
        </div>
    </div>
    {% else %}
    <div class="card registration-status-card mb-4">
        <div class="card-body text-center">
            <h3 class="card-title text-success">âœ… Registration Complete!</h3>
            <p class="card-text">You are all set for Sim2Real 2025. Explore your team profile and resources.</p>
            <a href="{% url 'teamprofile' %}" class="btn btn-outline-light">View Team Profile</a>
        </div>
    </div>
    {% endif %}

    <div class="row">
      {%if not registered%}
      <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-user"></i> My Profile</h5>
                    <p class="card-text">Form or join a team, manage requests, and collaborate with your members.</p>
                    <a href="{% url 'profile' %}" class="btn btn-sm btn-outline-light">My Profile</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-users me-2"></i> Team Management</h5>
                    <p class="card-text">Form or join a team, manage requests, and collaborate with your members.</p>
                    <a href="{% url 'teamprofile' %}" class="btn btn-sm btn-outline-light">Go to Team</a>
                </div>
            </div>
        </div>
        {%endif%}
        {%if registered%}
        <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-question-circle-o"></i> Scripting Quiz</h5>
                    <p class="card-text">Attempt Scripting Quiz</p>
                    <a href="#" class="btn btn-sm btn-outline-light">Attempt Now</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-file-upload me-2"></i> Project Submission</h5>
                    <p class="card-text">Submit your project, view guidelines, and track your submission status.</p>
                    <a href="#" class="btn btn-sm btn-outline-light">Submit Project</a> 
                </div>
            </div>
        </div>
    </div>
    {%endif%}
    <div class="card announcements-card mb-4">
         <h5 class="card-title"><i class="fas fa-bullhorn me-2" style="margin-top:20px;"></i> Latest Announcements</h5>
            {% for announcement in announcements %}
        <div class="card-body" style="padding:0px;">
            <ul class="list-unstyled">
                <li><p class="mb-1"><strong>{{announcement.created_at}}  :   </strong>      {{announcement.message}}</p></li>
            <li></li>
            </ul>
        </div>
    {%endfor%}
    <a href="{% url 'announcements' %}" class="btn btn-sm btn-outline-light mt-3" style="margin-bottom:20px;max-width:300px;">View All Announcements</a>
    </div>
  </section>
  {% endblock %}
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="{%static "home/script.js" %}"></script>
{% if messages %}
<div class="toast-container position-fixed top-0 end-0 p-3">
  {% for message in messages %}
  <div class="toast align-items-center text-white bg-{{ message.tags }} border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="d-flex">
      <div class="toast-body">
        {{ message }}
      </div>
      <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
  </div>
  {% endfor %}
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  var toastElList = [].slice.call(document.querySelectorAll('.toast'))
  toastElList.forEach(function(toastEl) {
    new bootstrap.Toast(toastEl, { delay: 5000 }).show()
  })
});
</script>
{% endif %}
<script>
    // Simple toggle for mobile menu (if not handled by Bootstrap's built-in collapse)
    function toggleMenu() {
        const dropdownMenu = document.getElementById('dropdownUser1').nextElementSibling;
        if (dropdownMenu.classList.contains('show')) {
            dropdownMenu.classList.remove('show');
        } else {
            dropdownMenu.classList.add('show');
        }
    }
    {% if show_welcome %}
    document.addEventListener("DOMContentLoaded", function () {
        setTimeout(() => {
            const overlay = document.getElementById("welcome-overlay");
            const content = document.getElementById("main-content");

            overlay.classList.add("fade-out");
            content.classList.add("show");
        }, 2500); // Show overlay for 2.5 seconds
    });
    {% endif %}
</script>
</body>
</html>
