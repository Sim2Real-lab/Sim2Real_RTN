{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SIM2REAL | ROBOTECH-NITK</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- Custom CSS (will be updated by you soon) -->
  <link rel="stylesheet" href="{%static "home/style.css" %}">
</head>
<body>
{% if show_welcome %}
<div id="welcome-overlay">
    Welcome to <strong style="margin-left: 10px;">Sim2Real</strong>
</div>
<div class="gear"></div>
{% endif %}

<!-- Main dashboard content here -->
<div id="main-content" {% if show_welcome %}style="visibility: hidden;"{% endif %}>
    <!-- Your actual dashboard content -->
</div>
<!-- Main body background for the Sim2Real theme -->
<div class="body-background"></div> 

<div class="top-panel">
<header class="d-flex justify-content-between align-items-center px-4 py-3">
  <div class="site-branding">
    <h1 class="mb-0">SIM2REAL 2025</h1>
    <p class="mb-0"><strong>ROBOTECH NITK</strong></p>
    <p class="tagline">Simulate. Build. Compete.</p>
  </div>
  <div class="user-info-section">
    {% if user.is_authenticated %}
      <div class="dropdown">
        <a class="d-flex align-items-center text-white text-decoration-none dropdown-toggle profile-dropdown-toggle" href="#" id="dropdownUser1" data-bs-toggle="dropdown" aria-expanded="false">
          <img src="{% static 'assets/default.png' %}" alt="Profile" class="profile-img rounded-circle me-2">
          <div class="d-flex flex-column align-items-start">
            <span class="welcome-text">Welcome</span>
            <strong class="username">{{ user.username }}</strong>
          </div>
        </a>
        <button id="menuToggleBtn" class="menu-toggle d-md-none ms-3" onclick="toggleMenu()">â˜°</button>
        <ul class="dropdown-menu dropdown-menu-end profile-dropdown-menu" aria-labelledby="dropdownUser1">
            <li><a class="dropdown-item" href="{%url 'profile'%}"><i class="fas fa-user me-2"></i> My Profile</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="{%url 'teamprofile'%}"><i class="fas fa-users me-2"></i> Team Profile</a></li>
            <li><hr class="dropdown-divider"></li>
            {% comment %} Show Manage Team only if user is a leader {% endcomment %}
            {% if user.led_team %}
            <li><a class="dropdown-item" href="{% url 'manage_requests' %}"><i class="fas fa-cogs me-2"></i> Manage Team</a></li>
            <li><hr class="dropdown-divider"></li>
            {% endif %}
            <li>
            <form method="post" action="{% url 'logout' %}">
                {% csrf_token %}
            <button type="submit" class="dropdown-item"><i class="fas fa-sign-out-alt me-2"></i> Logout</button>
            </form>
            </li>
        </ul>
      </div>
    {% endif %}
    
  </div>
</header>

<nav class="main-nav">
    <a href="{%url 'home'%}" class="nav-link-item">Dashboard</a><hr class="vertical">
  {%if not registered%}
  <a href="{%url 'manage_requests'%}" class="nav-link-item">Register</a>
  <a href="#" class="nav-link-item">Download Brochure</a>
  {%endif%}
  {% if registered%}
  <a href="{%url 'user_query'%}" class="nav-link-item">Problem Statement</a><hr class="vertical">
  <a href="{%url 'user_query'%}" class="nav-link-item">Resources</a><hr class="vertical">
  <!--<a href="#" class="nav-link-item">leaderboard</a><hr class="vertical">-->
  <!--<a href="#" class="nav-link-item">Test</a><hr class="vertical">-->
  {%endif%}
  <a href="{%url 'announcements'%}" class="nav-link-item">Announcements</a><hr class="vertical">
  <a href="{%url 'user_query'%}" class="nav-link-item">Queries-Ask Us</a>
</nav>
</div>

<div class="container main-content-area mt-4">
  {% block content %}
  <!-- Dynamic content relevant to a logged-in hackathon participant -->
  <section class="dashboard-section p-4 rounded-lg shadow-lg">
    <h2 class="text-center mb-4">Sim2Real 2025 Dashboard</h2>

    {% if not registered %} {# Placeholder condition #}
    <div class="card registration-card mb-4">
        <div class="card-body text-center">
            <h3 class="card-title">ðŸš€ Ready to Simulate to Real?</h3>
            <p class="card-text">Registration Closes on 14 September 2025.</br>Complete your registration to unlock full event features and team management.</p>
            <a href="{% url 'manage_requests' %}" class="btn btn-glow">Register Now!</a> {# Placeholder URL #}
        </div>
    </div>
    {% else %}
    <div class="card registration-status-card mb-4">
        <div class="card-body text-center">
            <h3 class="card-title text-success">âœ… Registration Complete!</h3>
            <p class="card-text">You are all set for Sim2Real 2025. Explore your team profile and resources.</p>
            <a href="{% url 'teamprofile' %}" class="btn btn-outline-light">View Team Profile</a>
        </div>
    </div>
    {% endif %}

    <div class="row">
      {%if not registered%}
      <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-user"></i> My Profile</h5>
                    <p class="card-text">Form or join a team, manage requests, and collaborate with your members.</p>
                    <a href="{% url 'profile' %}" class="btn btn-sm btn-outline-light">My Profile</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-users me-2"></i> Team Management</h5>
                    <p class="card-text">Form or join a team, manage requests, and collaborate with your members.</p>
                    <a href="{% url 'teamprofile' %}" class="btn btn-sm btn-outline-light">Go to Team</a>
                </div>
            </div>
        </div>
        {%endif%}
        {%if registered%}
        <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-question-circle-o"></i> Scripting Quiz</h5>
                    <p class="card-text">Attempt Scripting Quiz</p>
                    <a href="#" class="btn btn-sm btn-outline-light">Attempt Now</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card feature-card">
                <div class="card-body">
                    <h5 class="card-title"><i class="fas fa-file-upload me-2"></i> Project Submission</h5>
                    <p class="card-text">Submit your project, view guidelines, and track your submission status.</p>
                    <a href="#" class="btn btn-sm btn-outline-light">Submit Project</a> 
                </div>
            </div>
        </div>
    </div>
    {%endif%}
    <div class="card announcements-card mb-4">
         <h5 class="card-title"><i class="fas fa-bullhorn me-2" style="margin-top:20px;"></i> Latest Announcements</h5>
            {% for announcement in announcements %}
        <div class="card-body" style="padding:0px;">
            <ul class="list-unstyled">
                <li><p class="mb-1"><strong>{{announcement.created_at}}  :   </strong>      {{announcement.message}}</p></li>
            <li></li>
            </ul>
        </div>
    {%endfor%}
    <a href="{% url 'announcements' %}" class="btn btn-sm btn-outline-light mt-3" style="margin-bottom:20px;max-width:300px;">View All Announcements</a>
    </div>
  </section>
  {% endblock %}
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="{%static "home/script.js" %}"></script>
<script>
    // Simple toggle for mobile menu (if not handled by Bootstrap's built-in collapse)
    function toggleMenu() {
        const dropdownMenu = document.getElementById('dropdownUser1').nextElementSibling;
        if (dropdownMenu.classList.contains('show')) {
            dropdownMenu.classList.remove('show');
        } else {
            dropdownMenu.classList.add('show');
        }
    }
    {% if show_welcome %}
    document.addEventListener("DOMContentLoaded", function () {
        setTimeout(() => {
            const overlay = document.getElementById("welcome-overlay");
            const content = document.getElementById("main-content");

            overlay.classList.add("fade-out");
            content.classList.add("show");
        }, 2500); // Show overlay for 2.5 seconds
    });
    {% endif %}
</script>
</body>
</html>
